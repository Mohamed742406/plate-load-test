<!DOCTYPE html>
<html lang="ar" dir="ltr">
<head>
Â  Â  <meta charset="UTF-8">
Â  Â  <meta name="viewport" content="width=device-width, initial-scale=1.0">
Â  Â  <title>Platform: Plate Load Test (ASTM & DIN)</title>
Â  Â  <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
Â  Â  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
Â  Â  <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels@2.0.0"></script>
Â  Â  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/9.4.4/math.min.js"></script>Â 
Â  Â  <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;600;700;800&display=swap" rel="stylesheet">
Â  Â Â 
Â  Â  <style>
Â  Â  Â  Â  /* --- ØªÙ†Ø³ÙŠÙ‚Ø§Øª Ø¹Ø§Ù…Ø© --- */
Â  Â  Â  Â  body { font-family: 'Cairo', sans-serif; background-color: #f0f2f5; margin: 0; padding: 0; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Ø´Ø±ÙŠØ· Ø§Ù„ØªÙ†Ù‚Ù„ Ø§Ù„Ø¹Ù„ÙˆÙŠ */
Â  Â  Â  Â  .main-nav { background: #2c3e50; padding: 15px; text-align: center; box-shadow: 0 4px 6px rgba(0,0,0,0.1); position: sticky; top:0; z-index: 1000; }
Â  Â  Â  Â  .std-btn {Â 
Â  Â  Â  Â  Â  Â  background: transparent; color: #ecf0f1; border: 2px solid #ecf0f1;Â 
Â  Â  Â  Â  Â  Â  padding: 8px 25px; margin: 0 10px; border-radius: 30px;Â 
Â  Â  Â  Â  Â  Â  font-weight: bold; cursor: pointer; transition: all 0.3s; font-size: 1.1em;
Â  Â  Â  Â  }
Â  Â  Â  Â  .std-btn:hover, .std-btn.active { background: #e67e22; color: white; border-color: #e67e22; transform: scale(1.05); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Ø¥Ø®ÙØ§Ø¡ ÙˆØ¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø§Øª */
Â  Â  Â  Â  .view-section { display: none; animation: fadeIn 0.5s; }
Â  Â  Â  Â  .view-section.active { display: block; }
Â  Â  Â  Â  @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }

Â  Â  Â  Â  /* Ø­Ø§ÙˆÙŠØ© Ø§Ù„ØªÙ‚Ø±ÙŠØ± (Ù†ÙØ³ Ø§Ù„Ù‚Ø¯ÙŠÙ…) */
Â  Â  Â  Â  .report-container { max-width: 210mm; margin: 30px auto; background: white; padding: 40px; box-shadow: 0 0 20px rgba(0,0,0,0.1); min-height: 297mm; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Ø§Ù„Ø¬Ø¯Ø§ÙˆÙ„ */
Â  Â  Â  Â  table { border-collapse: collapse; width: 100%; margin-bottom: 10px; }
Â  Â  Â  Â  th, td { border: 1px solid #333; padding: 6px 8px; text-align: center; font-size: 12px; vertical-align: middle; }
Â  Â  Â  Â  th { background-color: #e8e8e8; font-weight: bold; line-height: 1.4; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Ø§Ù„Ù†ØµÙˆØµ */
Â  Â  Â  Â  .ar-text { font-weight: 700; font-size: 1em; color: #1a1a1a; display: block; }
Â  Â  Â  Â  .en-sub { font-size: 0.75em; color: #555; font-weight: normal; display: block; margin-top: 2px; }
Â  Â  Â  Â  .bilingual-label { text-align: center; line-height: 1.3; }
Â  Â  Â  Â  .label-cell { background-color: #f5f5f5; font-weight: bold; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª */
Â  Â  Â  Â  input[type="text"], input[type="number"], input[type="date"] {
Â  Â  Â  Â  Â  Â  border: none; border-bottom: 1px solid #999; padding: 4px; width: 100%; text-align: center; background: transparent; font-family: 'Cairo', Arial, sans-serif;
Â  Â  Â  Â  }
Â  Â  Â  Â  input:focus { outline: none; border-bottom-color: #0066cc; }
Â  Â  Â  Â  input[readonly] { background-color: #e8f4fc; border-bottom: 2px solid #0066cc; font-weight: bold; color: #0066cc; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .section-title { background-color: #d4d4d4; padding: 10px 12px; font-weight: bold; border: 1px solid #333; margin-top: 20px; text-align: center; }
Â  Â  Â  Â  .calculated { background-color: #f0f8ff; }
Â  Â  Â  Â  .stress-calculated { background-color: #e8f5e9; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  /* Ø§Ù„Ø£Ø²Ø±Ø§Ø± */
Â  Â  Â  Â  .btn { padding: 8px 16px; margin: 4px; border: none; border-radius: 4px; cursor: pointer; font-size: 13px; transition: all 0.2s; font-family: 'Cairo'; }
Â  Â  Â  Â  .btn-primary { background-color: #0066cc; color: white; }
Â  Â  Â  Â  .btn-danger { background-color: #dc3545; color: white; }
Â  Â  Â  Â  .btn-success { background-color: #28a745; color: white; }
Â  Â  Â  Â  .btn-warning { background-color: #ffc107; color: #212529; }
Â  Â  Â  Â  .btn-info { background-color: #17a2b8; color: white; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .header-logo { border: 2px solid #333; padding: 20px; text-align: center; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .tabs-nav { display: flex; border-bottom: 3px solid #0066cc; margin-bottom: 0; background: linear-gradient(to bottom, #f8f9fa, #e9ecef); border-radius: 8px 8px 0 0; }
Â  Â  Â  Â  .tab-btn { flex: 1; padding: 15px 10px; text-align: center; cursor: pointer; border: none; border-right: 1px solid #dee2e6; transition: all 0.3s ease; position: relative; }
Â  Â  Â  Â  .tab-btn.active { background: #0066cc; color: white; }
Â  Â  Â  Â  .tab-btn.active .ar-text { color: white; }
Â  Â  Â  Â  .tab-btn.active .en-sub { color: rgba(255, 255, 255, 0.85); }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .tab-content { display: none; padding: 20px 0; animation: fadeIn 0.3s ease; }
Â  Â  Â  Â  .tab-content.active { display: block; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .nav-buttons { display: flex; justify-content: space-between; margin-top: 20px; padding-top: 20px; border-top: 2px solid #e9ecef; }
Â  Â  Â  Â  .load-step-title { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 8px 15px; border-radius: 5px; margin: 15px 0 10px 0; text-align: center; display: flex; align-items: center; justify-content: center; gap: 10px; }
Â  Â  Â  Â  .load-step-title input { background: rgba(255,255,255,0.2); border: 1px solid rgba(255,255,255,0.5); color: white; text-align: center; font-weight: bold; max-width: 200px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .plate-info-box { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); border-radius: 8px; padding: 15px; margin-bottom: 15px; color: white; }
Â  Â  Â  Â  .plate-info-box input { background: rgba(255,255,255,0.9); border: none; border-radius: 4px; padding: 8px 12px; text-align: center; font-weight: bold; font-size: 1.1em; color: #333; }
Â  Â  Â  Â  .global-actions { background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%); border-radius: 8px; padding: 15px; margin: 15px 0; display: flex; flex-wrap: wrap; justify-content: center; gap: 10px; }
Â  Â  Â  Â Â 
Â  Â  Â  Â  .mpa-input { background-color: #fffde7 !important; border-bottom: 1px dashed #fbc02d !important; }

Â  Â  Â  Â  /* ØªÙ†Ø³ÙŠÙ‚Ø§Øª DIN Ø§Ù„Ø¬Ø¯ÙŠØ¯Ø© */
Â  Â  Â  Â  .din-header { border-bottom: 4px solid #e67e22; padding-bottom: 10px; margin-bottom: 20px; }
Â  Â  Â  Â  .din-result-box { background: #fff3e0; border: 2px solid #e67e22; border-radius: 10px; padding: 15px; text-align: center; margin-top: 20px; }
Â  Â  Â  Â  .cycle-header { background: #e67e22; color: white; padding: 5px; font-weight: bold; margin-top: 15px; border-radius: 4px; text-align: center; }

Â  Â  Â  Â  @media print {
Â  Â  Â  Â  Â  Â  .no-print, .main-nav { display: none !important; }
Â  Â  Â  Â  Â  Â  .view-section { display: none; }
Â  Â  Â  Â  Â  Â  .view-section.active { display: block !important; }
Â  Â  Â  Â  Â  Â  .tab-content { display: block !important; opacity: 1 !important; visibility: visible !important; height: auto !important; overflow: visible !important; }
Â  Â  Â  Â  Â  Â  .nav-buttons { display: none !important; }
Â  Â  Â  Â  Â  Â  .page-break { page-break-before: always; }
Â  Â  Â  Â  Â  Â  table { page-break-inside: auto; }
Â  Â  Â  Â  Â  Â  tr { page-break-inside: avoid; page-break-after: auto; }
Â  Â  Â  Â  Â  Â  body { padding: 0 !important; margin: 0 !important; font-size: 10pt; }
Â  Â  Â  Â  Â  Â  .report-container { box-shadow: none; max-width: 100%; width: 100%; margin: 0; padding: 0; }
Â  Â  Â  Â  Â  Â  .tabs-nav { display: none !important; }
Â  Â  Â  Â  Â  Â  #tab1Content, #tab2Content { page-break-after: always; border-bottom: none !important; }
Â  Â  Â  Â  }
Â  Â  </style>
</head>
<body>

Â  Â  <div class="main-nav no-print">
Â  Â  Â  Â  <button class="std-btn active" onclick="switchStandard('ASTM')">ASTM D1194</button>
Â  Â  Â  Â  <button class="std-btn" onclick="switchStandard('DIN')">DIN 18134</button>
Â  Â  </div>

Â  Â  <div id="view-ASTM" class="view-section active">
Â  Â  Â  Â  <div class="report-container p-8">
Â  Â  Â  Â  Â  Â  <div class="header-logo mb-6 flex items-center justify-between relative">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-1/4 flex justify-center items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <img id="companyLogo" src="#" alt="Company Logo" class="max-h-24 object-contain hidden">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print text-center" id="uploadLogoBtnContainer">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label for="logoInput" class="cursor-pointer bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-2 px-4 rounded inline-block text-xs">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ğŸ“· Ø±ÙØ¹ Ù„ÙˆØ¬Ùˆ<br>Upload Logo
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="file" id="logoInput" accept="image/*" class="hidden" onchange="loadLogo(event, 'ASTM')">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-2/4 text-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h1>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="ar-text text-xl">ØªÙ‚Ø±ÙŠØ± Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„ÙˆØ­</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small class="en-sub text-sm">PLATE LOAD TEST REPORT</small>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </h1>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2 class="text-lg text-gray-600">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="ar-text">ÙˆÙÙ‚Ø§Ù‹ Ù„Ù„Ù…ÙˆØ§ØµÙØ© ASTM D1194</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small class="en-sub">According to ASTM D1194</small>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </h2>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-1/4"></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="no-print mb-4 flex gap-2 justify-center flex-wrap">
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="window.print()" class="btn btn-success">ğŸ–¨ï¸ Ø·Ø¨Ø§Ø¹Ø© Ø§Ù„ØªÙ‚Ø±ÙŠØ±</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="generateChart()" class="btn btn-primary">ğŸ“Š ØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±Ø³Ù… Ø§Ù„Ø¨ÙŠØ§Ù†ÙŠ</button>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="section-title"><span class="ar-text">Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</span><small class="en-sub">PROJECT INFORMATION</small></div>
Â  Â  Â  Â  Â  Â  <table class="mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="label-cell w-1/4 bilingual-label"><span class="ar-text">Ø§Ø³Ù… Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</span><small class="en-sub">Project Name</small></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td><input type="text" id="projectName"></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="label-cell w-1/4 bilingual-label"><span class="ar-text">Ø±Ù‚Ù… Ø§Ù„Ø·Ù„Ø¨</span><small class="en-sub">Order No.</small></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td><input type="text" id="orderNo"></td>
Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="label-cell bilingual-label"><span class="ar-text">Ø§Ù„Ø¹Ù…ÙŠÙ„</span><small class="en-sub">Client</small></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td><input type="text" id="client"></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="label-cell bilingual-label"><span class="ar-text">ØªØ§Ø±ÙŠØ® Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</span><small class="en-sub">Test Date</small></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td><input type="date" id="testDate"></td>
Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="label-cell bilingual-label"><span class="ar-text">Ø§Ù„Ù…ÙˆÙ‚Ø¹</span><small class="en-sub">Location</small></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td><input type="text" id="location"></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="label-cell bilingual-label"><span class="ar-text">ØªØ§Ø±ÙŠØ® Ø§Ù„ØªÙ‚Ø±ÙŠØ±</span><small class="en-sub">Report Date</small></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td><input type="date" id="reportDate"></td>
Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  </table>

Â  Â  Â  Â  Â  Â  <div class="bg-blue-50 p-4 rounded mb-4 border border-blue-200 no-print">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex flex-wrap justify-center gap-6 items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="font-bold text-blue-900">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ÙˆØ­Ø¯Ø© Ù‚ÙŠØ§Ø³ Ø§Ù„Ø¹Ø¯Ø§Ø¯ (Gauge Unit):
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <select id="gauge_unit" class="p-1 border rounded dir-ltr" onchange="updateCalculations()">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="MPa">MPa (Ù…ÙŠØ¬Ø§Ø¨Ø§Ø³ÙƒØ§Ù„)</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="Bar">Bar (Ø¨Ø§Ø±)</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="psi">psi (Ø±Ø·Ù„/Ø¨ÙˆØµØ©Â²)</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <option value="kg_cm2">kg/cmÂ² (ÙƒØ¬Ù…/Ø³Ù…Â²)</option>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </select>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-gray-400">|</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="font-bold text-blue-900">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Ù‚Ø¯Ø±Ø© ØªØ­Ù…Ù„ Ø§Ù„ØªØ±Ø¨Ø© (Design Load):
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="design_load" placeholder="Ù…Ø«Ù„Ø§Ù‹ 1.5" class="bg-white p-1 w-20 border rounded" oninput="autoUpdateStages()"> kg/cmÂ²
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </label>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center mt-2 text-sm text-gray-500">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  * Ø³ÙŠØªÙ… ØªØ­ÙˆÙŠÙ„ Ù‚Ø±Ø§Ø¡Ø© Ø§Ù„Ø¹Ø¯Ø§Ø¯ Ø£ÙˆØªÙˆÙ…Ø§ØªÙŠÙƒÙŠØ§Ù‹ ÙˆØªØ­Ø¯ÙŠØ« Ø¹Ù†Ø§ÙˆÙŠÙ† Ù…Ø±Ø§Ø­Ù„ Ø§Ù„ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù€ 6 Ø¨Ø§Ù„Ø£Ø³ÙÙ„.
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="plate-info-box no-print">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex flex-wrap items-center justify-center gap-6">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="label bilingual-label"><span class="ar-text" style="color:white;">Ù‚Ø·Ø± Ø§Ù„Ù„ÙˆØ­ (Ø³Ù…)</span><small class="en-sub" style="color:rgba(255,255,255,0.85);">Plate Diameter (cm)</small></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="number" id="plateDiameter" value="45.72" step="0.1" min="1" oninput="calculatePlateArea()" style="width:120px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center text-3xl" style="color:rgba(255,255,255,0.7);">â†’</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="label bilingual-label"><span class="ar-text" style="color:white;">Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù„ÙˆØ­ (Ø³Ù…Â²)</span><small class="en-sub" style="color:rgba(255,255,255,0.85);">Plate Area (cmÂ²)</small></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" id="plateArea" readonly style="width:150px; background:#e8f4fc; color:#0066cc;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="text-center ml-4 pl-4 border-l border-white/30">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <div class="label bilingual-label"><span class="ar-text" style="color:#ffebb5;">Ù…Ø¹Ø§Ù…Ù„ Ø§Ù„ØªØ­ÙˆÙŠÙ„</span><small class="en-sub" style="color:rgba(255,255,255,0.85);">Conversion Factor</small></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â <input type="number" id="ramFactor" value="16.428" style="width:100px; color:#c62828;" title="ÙŠØªÙ… Ø¶Ø±Ø¨ Ø§Ù„Ù…ÙŠØ¬Ø§Ø¨Ø§Ø³ÙƒØ§Ù„ ÙÙŠ Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ Ø§Ù„Ø·Ù†">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <table class="mb-4" style="display:none;" id="plateInfoPrint">
Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="label-cell w-1/4 bilingual-label"><span class="ar-text">Ù‚Ø·Ø± Ø§Ù„Ù„ÙˆØ­ (Ø³Ù…)</span><small class="en-sub">Plate Diameter (cm)</small></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td id="plateDiameterPrint">45.72</td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="label-cell w-1/4 bilingual-label"><span class="ar-text">Ù…Ø³Ø§Ø­Ø© Ø§Ù„Ù„ÙˆØ­ (Ø³Ù…Â²)</span><small class="en-sub">Plate Area (cmÂ²)</small></td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td id="plateAreaPrint">1641.73</td>
Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  </table>

Â  Â  Â  Â  Â  Â  <div class="global-actions no-print">
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="calculateAllResults()" class="btn btn-info">ğŸ”„ Ø­Ø³Ø§Ø¨ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù†ØªØ§Ø¦Ø¬</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="saveToLocal()" class="btn btn-success" style="background-color: #198754;">ğŸ’¾ Ø­ÙØ¸ Ù…Ø¤Ù‚Øª</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="loadFromLocal()" class="btn btn-warning" style="background-color: #ffc107; color:black;">ğŸ“‚ Ø§Ø³ØªØ±Ø¬Ø§Ø¹</button>
Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="resetNewTest()" class="btn btn-danger">ğŸ—‘ï¸ Ø¥Ø¹Ø§Ø¯Ø© ØªØ¹ÙŠÙŠÙ†</button>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="tabs-nav no-print" id="tabsNav">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="tab-btn active" onclick="switchTab(1)" id="tab1Btn"><span class="tab-indicator">1</span> <span class="ar-text">Ø§Ù„Ù‚Ø³Ù… Ø£ - Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„</span><small class="en-sub">Section A - Loading Stage</small></button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="tab-btn" onclick="switchTab(2)" id="tab2Btn"><span class="tab-indicator">2</span> <span class="ar-text">Ø§Ù„Ù‚Ø³Ù… Ø¨ - Ù…Ø±Ø­Ù„Ø© Ø±ÙØ¹ Ø§Ù„Ø­Ù…Ù„</span><small class="en-sub">Section B - Unloading Stage</small></button>
Â  Â  Â  Â  Â  Â  Â  Â  <button class="tab-btn" onclick="switchTab(3)" id="tab3Btn"><span class="tab-indicator">3</span> <span class="ar-text">Ø§Ù„Ù‚Ø³Ù… Ø¬ - Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙˆØ§Ù„Ù…Ù†Ø­Ù†ÙŠØ§Øª</span><small class="en-sub">Section C - Results & Curves</small></button>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="tab-content active" id="tab1Content">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="section-title"><span class="ar-text">Ø£- Ù…Ø±Ø­Ù„Ø© Ø§Ù„ØªØ­Ù…ÙŠÙ„</span><small class="en-sub">A- LOADING STAGE</small></div>
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  <div class="load-step-title"><div class="bilingual-label"><span class="ar-text">Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¬Ù‡Ø§Ø¯</span><small class="en-sub">Stress Level</small></div><input type="text" id="loadingStageLabel1" value="0.70 kg/cmÂ²"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print mb-2 mt-2 text-center"><button onclick="addLoadingRow('loading1')" class="btn btn-primary">+ Ø¥Ø¶Ø§ÙØ© ØµÙ</button><button onclick="removeLastRow('loading1Body')" class="btn btn-danger">- Ø­Ø°Ù</button></div>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="loading1Table" class="mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr><th class="bilingual-label">Ø§Ù„ÙˆÙ‚Øª<br><small>Time</small></th><th class="bilingual-label bg-yellow-50">Ø§Ù„Ø¶ØºØ·<br><span class="unit-disp">(MPa)</span></th><th class="bilingual-label bg-gray-50">Ø§Ù„Ø­Ù…Ù„<br><small>Ton</small></th><th>G1</th><th>G2</th><th>G3</th><th class="calculated">Avg</th><th class="calculated">Sett.</th><th class="stress-calculated">Stress</th><th>Temp</th><th class="no-print">X</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="loading1Body"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  </table>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="load-step-title"><div class="bilingual-label"><span class="ar-text">Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¬Ù‡Ø§Ø¯</span><small class="en-sub">Stress Level</small></div><input type="text" id="loadingStageLabel2" value="1.40 kg/cmÂ²"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print mb-2 mt-2 text-center"><button onclick="addLoadingRow('loading2')" class="btn btn-primary">+ Ø¥Ø¶Ø§ÙØ© ØµÙ</button><button onclick="removeLastRow('loading2Body')" class="btn btn-danger">- Ø­Ø°Ù</button></div>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="loading2Table" class="mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr><th class="bilingual-label">Ø§Ù„ÙˆÙ‚Øª<br><small>Time</small></th><th class="bilingual-label bg-yellow-50">Ø§Ù„Ø¶ØºØ·<br><span class="unit-disp">(MPa)</span></th><th class="bilingual-label bg-gray-50">Ø§Ù„Ø­Ù…Ù„<br><small>Ton</small></th><th>G1</th><th>G2</th><th>G3</th><th class="calculated">Avg</th><th class="calculated">Sett.</th><th class="stress-calculated">Stress</th><th>Temp</th><th class="no-print">X</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="loading2Body"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  </table>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="load-step-title"><div class="bilingual-label"><span class="ar-text">Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¬Ù‡Ø§Ø¯</span><small class="en-sub">Stress Level</small></div><input type="text" id="loadingStageLabel3" value="2.10 kg/cmÂ²"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print mb-2 mt-2 text-center"><button onclick="addLoadingRow('loading3')" class="btn btn-primary">+ Ø¥Ø¶Ø§ÙØ© ØµÙ</button><button onclick="removeLastRow('loading3Body')" class="btn btn-danger">- Ø­Ø°Ù</button></div>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="loading3Table" class="mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr><th class="bilingual-label">Ø§Ù„ÙˆÙ‚Øª<br><small>Time</small></th><th class="bilingual-label bg-yellow-50">Ø§Ù„Ø¶ØºØ·<br><span class="unit-disp">(MPa)</span></th><th class="bilingual-label bg-gray-50">Ø§Ù„Ø­Ù…Ù„<br><small>Ton</small></th><th>G1</th><th>G2</th><th>G3</th><th class="calculated">Avg</th><th class="calculated">Sett.</th><th class="stress-calculated">Stress</th><th>Temp</th><th class="no-print">X</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="loading3Body"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  </table>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="load-step-title"><div class="bilingual-label"><span class="ar-text">Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¬Ù‡Ø§Ø¯</span><small class="en-sub">Stress Level</small></div><input type="text" id="loadingStageLabel4" value="2.80 kg/cmÂ²"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print mb-2 mt-2 text-center"><button onclick="addLoadingRow('loading4')" class="btn btn-primary">+ Ø¥Ø¶Ø§ÙØ© ØµÙ</button><button onclick="removeLastRow('loading4Body')" class="btn btn-danger">- Ø­Ø°Ù</button></div>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="loading4Table" class="mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr><th class="bilingual-label">Ø§Ù„ÙˆÙ‚Øª<br><small>Time</small></th><th class="bilingual-label bg-yellow-50">Ø§Ù„Ø¶ØºØ·<br><span class="unit-disp">(MPa)</span></th><th class="bilingual-label bg-gray-50">Ø§Ù„Ø­Ù…Ù„<br><small>Ton</small></th><th>G1</th><th>G2</th><th>G3</th><th class="calculated">Avg</th><th class="calculated">Sett.</th><th class="stress-calculated">Stress</th><th>Temp</th><th class="no-print">X</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="loading4Body"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  </table>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="load-step-title"><div class="bilingual-label"><span class="ar-text">Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¬Ù‡Ø§Ø¯</span><small class="en-sub">Stress Level</small></div><input type="text" id="loadingStageLabel5" value="3.50 kg/cmÂ²"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print mb-2 mt-2 text-center"><button onclick="addLoadingRow('loading5')" class="btn btn-primary">+ Ø¥Ø¶Ø§ÙØ© ØµÙ</button><button onclick="removeLastRow('loading5Body')" class="btn btn-danger">- Ø­Ø°Ù</button></div>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="loading5Table" class="mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr><th class="bilingual-label">Ø§Ù„ÙˆÙ‚Øª<br><small>Time</small></th><th class="bilingual-label bg-yellow-50">Ø§Ù„Ø¶ØºØ·<br><span class="unit-disp">(MPa)</span></th><th class="bilingual-label bg-gray-50">Ø§Ù„Ø­Ù…Ù„<br><small>Ton</small></th><th>G1</th><th>G2</th><th>G3</th><th class="calculated">Avg</th><th class="calculated">Sett.</th><th class="stress-calculated">Stress</th><th>Temp</th><th class="no-print">X</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="loading5Body"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  </table>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="load-step-title"><div class="bilingual-label"><span class="ar-text">Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¬Ù‡Ø§Ø¯</span><small class="en-sub">Stress Level</small></div><input type="text" id="loadingStageLabel6" value="4.20 kg/cmÂ²"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print mb-2 mt-2 text-center"><button onclick="addLoadingRow('loading6')" class="btn btn-primary">+ Ø¥Ø¶Ø§ÙØ© ØµÙ</button><button onclick="removeLastRow('loading6Body')" class="btn btn-danger">- Ø­Ø°Ù</button></div>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="loading6Table" class="mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr><th class="bilingual-label">Ø§Ù„ÙˆÙ‚Øª<br><small>Time</small></th><th class="bilingual-label bg-yellow-50">Ø§Ù„Ø¶ØºØ·<br><span class="unit-disp">(MPa)</span></th><th class="bilingual-label bg-gray-50">Ø§Ù„Ø­Ù…Ù„<br><small>Ton</small></th><th>G1</th><th>G2</th><th>G3</th><th class="calculated">Avg</th><th class="calculated">Sett.</th><th class="stress-calculated">Stress</th><th>Temp</th><th class="no-print">X</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="loading6Body"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  </table>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="nav-buttons no-print"><div></div><button onclick="switchTab(2)" class="btn btn-primary btn-nav"><span class="ar-text">Ø§Ù„Ø®Ø·ÙˆØ© Ø§Ù„ØªØ§Ù„ÙŠØ©</span> â†’</button></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="tab-content" id="tab2Content">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="section-title"><span class="ar-text">Ø¨- Ù…Ø±Ø­Ù„Ø© Ø±ÙØ¹ Ø§Ù„Ø­Ù…Ù„</span><small class="en-sub">B- UNLOADING STAGE</small></div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="load-step-title" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"><div class="bilingual-label"><span class="ar-text">Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¬Ù‡Ø§Ø¯</span><small class="en-sub">Stress Level</small></div><input type="text" id="unloadingStageLabel1" value="2.80 kg/cmÂ²"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print mb-2 mt-2 text-center"><button onclick="addUnloadingRow('unloading1')" class="btn btn-primary">+ Ø¥Ø¶Ø§ÙØ© ØµÙ</button><button onclick="removeLastRow('unloading1Body')" class="btn btn-danger">- Ø­Ø°Ù</button></div>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="unloading1Table" class="mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr><th class="bilingual-label">Ø§Ù„ÙˆÙ‚Øª<br><small>Time</small></th><th class="bilingual-label bg-yellow-50">Ø§Ù„Ø¶ØºØ·<br><span class="unit-disp">(MPa)</span></th><th class="bilingual-label bg-gray-50">Ø§Ù„Ø­Ù…Ù„<br><small>Ton</small></th><th>G1</th><th>G2</th><th>G3</th><th class="calculated">Avg</th><th class="calculated">Sett.</th><th class="stress-calculated">Stress</th><th>Temp</th><th class="no-print">X</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="unloading1Body"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  </table>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="load-step-title" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"><div class="bilingual-label"><span class="ar-text">Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¬Ù‡Ø§Ø¯</span><small class="en-sub">Stress Level</small></div><input type="text" id="unloadingStageLabel2" value="1.40 kg/cmÂ²"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print mb-2 mt-2 text-center"><button onclick="addUnloadingRow('unloading2')" class="btn btn-primary">+ Ø¥Ø¶Ø§ÙØ© ØµÙ</button><button onclick="removeLastRow('unloading2Body')" class="btn btn-danger">- Ø­Ø°Ù</button></div>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="unloading2Table" class="mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr><th class="bilingual-label">Ø§Ù„ÙˆÙ‚Øª<br><small>Time</small></th><th class="bilingual-label bg-yellow-50">Ø§Ù„Ø¶ØºØ·<br><span class="unit-disp">(MPa)</span></th><th class="bilingual-label bg-gray-50">Ø§Ù„Ø­Ù…Ù„<br><small>Ton</small></th><th>G1</th><th>G2</th><th>G3</th><th class="calculated">Avg</th><th class="calculated">Sett.</th><th class="stress-calculated">Stress</th><th>Temp</th><th class="no-print">X</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="unloading2Body"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  </table>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="load-step-title" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);"><div class="bilingual-label"><span class="ar-text">Ù…Ø±Ø­Ù„Ø© Ø§Ù„Ø¥Ø¬Ù‡Ø§Ø¯</span><small class="en-sub">Stress Level</small></div><input type="text" id="unloadingStageLabel3" value="0.00 kg/cmÂ²"></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print mb-2 mt-2 text-center"><button onclick="addUnloadingRow('unloading3')" class="btn btn-primary">+ Ø¥Ø¶Ø§ÙØ© ØµÙ</button><button onclick="removeLastRow('unloading3Body')" class="btn btn-danger">- Ø­Ø°Ù</button></div>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="unloading3Table" class="mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr><th class="bilingual-label">Ø§Ù„ÙˆÙ‚Øª<br><small>Time</small></th><th class="bilingual-label bg-yellow-50">Ø§Ù„Ø¶ØºØ·<br><span class="unit-disp">(MPa)</span></th><th class="bilingual-label bg-gray-50">Ø§Ù„Ø­Ù…Ù„<br><small>Ton</small></th><th>G1</th><th>G2</th><th>G3</th><th class="calculated">Avg</th><th class="calculated">Sett.</th><th class="stress-calculated">Stress</th><th>Temp</th><th class="no-print">X</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="unloading3Body"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  </table>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="nav-buttons no-print">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="switchTab(1)" class="btn btn-warning btn-nav">â† <span class="ar-text">Ø§Ù„Ø³Ø§Ø¨Ù‚</span></button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="switchTab(3)" class="btn btn-primary btn-nav"><span class="ar-text">Ø§Ù„ØªØ§Ù„ÙŠ</span> â†’</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="tab-content" id="tab3Content">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="section-title"><span class="ar-text">Ù…Ù„Ø®Øµ Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø±</span><small class="en-sub">SUMMARY OF TEST RESULTS</small></div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print mb-2 mt-2 text-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="addSummaryRow()" class="btn btn-primary">+ ØµÙ</button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="autoFillSummary()" class="btn btn-success">âš¡ ØªØ¹Ø¨Ø¦Ø© ØªÙ„Ù‚Ø§Ø¦ÙŠØ© ÙˆØ±Ø³Ù…</button>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <table id="summaryTable">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="bilingual-label"><span class="ar-text">Ø§Ù„Ù…Ø±Ø­Ù„Ø©</span><small class="en-sub">Stage</small></th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="bilingual-label"><span class="ar-text">Ø§Ù„Ø­Ù…Ù„ (Ø·Ù†)</span><small class="en-sub">Load (ton)</small></th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="calculated bilingual-label"><span class="ar-text">Ø§Ù„Ø¥Ø¬Ù‡Ø§Ø¯ (ÙƒØ¬Ù…/Ø³Ù…Â²)</span><small class="en-sub">Stress (kg/cmÂ²)</small></th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="bilingual-label"><span class="ar-text">Ø§Ù„Ù‡Ø¨ÙˆØ· (Ù…Ù…)</span><small class="en-sub">Settlement (mm)</small></th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <th class="no-print bilingual-label">X</th>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody id="summaryBody"></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  </table>

Â  Â  Â  Â  Â  Â  Â  Â <div class="section-title page-break mt-6"><span class="ar-text">Ø¬- Ø§Ù„Ù…Ù†Ø­Ù†ÙŠØ§Øª</span><small class="en-sub">C- CURVES (Stress vs Settlement)</small></div>
Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  <div class="mt-4 p-4 border border-gray-300" style="height: 500px;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <canvas id="stressSettlementChart"></canvas>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="mt-6 p-4 bg-indigo-50 border border-indigo-200 rounded-lg text-center shadow-sm">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h3 class="text-indigo-900 font-bold text-lg mb-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="ar-text">Ù…Ø¹Ø§Ù…Ù„ Ø±Ø¯ ÙØ¹Ù„ Ø§Ù„ØªØ±Ø¨Ø© (K-Value)</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small class="en-sub block font-normal text-sm">Modulus of Subgrade Reaction</small>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </h3>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-center items-baseline gap-2 dir-ltr">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-gray-600 font-bold">K = </span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span id="kValueResult" class="text-4xl font-bold text-indigo-700">0.00</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="text-gray-500 font-bold">kg/cmÂ³</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-xs text-gray-500 mt-2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  * Calculated based on maximum loading point (P/Î”)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <br> * ÙŠØªÙ… Ø§Ù„Ø­Ø³Ø§Ø¨ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø£Ù‚ØµÙ‰ Ù†Ù‚Ø·Ø© ØªØ­Ù…ÙŠÙ„ (Ø§Ù„Ø¥Ø¬Ù‡Ø§Ø¯ / Ø§Ù„Ù‡Ø¨ÙˆØ· Ø¨Ø§Ù„Ø³Ù…)
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  Â  Â  <div class="nav-buttons no-print">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <button onclick="switchTab(2)" class="btn btn-warning btn-nav">â† <span class="ar-text">Ø§Ù„Ø³Ø§Ø¨Ù‚</span></button>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div></div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â <div class="mt-8 pt-4 border-t-2 border-gray-400">
Â  Â  Â  Â  Â  Â  Â  Â  <table class="signature-section" style="border:none;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tr style="border:none;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="w-1/3 text-center p-4" style="border:none;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="border-t border-black pt-2 mt-8">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" class="text-center w-full font-bold mb-1 bg-transparent" placeholder="Ø§Ù„Ø§Ø³Ù… / Name" style="border:none;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="ar-text block">ÙØ­Øµ Ø¨ÙˆØ§Ø³Ø·Ø©</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small class="en-sub">Tested By</small>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="w-1/3 text-center p-4" style="border:none;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="border-t border-black pt-2 mt-8">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" class="text-center w-full font-bold mb-1 bg-transparent" placeholder="Ø§Ù„Ø§Ø³Ù… / Name" style="border:none;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="ar-text block">Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¨ÙˆØ§Ø³Ø·Ø©</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small class="en-sub">Checked By</small>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <td class="w-1/3 text-center p-4" style="border:none;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="border-t border-black pt-2 mt-8">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <input type="text" class="text-center w-full font-bold mb-1 bg-transparent" placeholder="Ø§Ù„Ø§Ø³Ù… / Name" style="border:none;">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <span class="ar-text block">Ø§Ø¹ØªÙ…Ø§Ø¯ Ø¨ÙˆØ§Ø³Ø·Ø©</span>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <small class="en-sub">Approved By</small>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </td>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </tr>
Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="mt-8 mb-4 text-center border-t border-gray-300 pt-4">
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-2xl font-bold text-indigo-800" style="text-shadow: 1px 1px 2px rgba(0,0,0,0.1);">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªØ·ÙˆÙŠØ±: Ù…/ Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯ Ø§Ù„Ù‚ØµØ¨ÙŠ
Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  Â  Â  <p class="text-sm text-gray-500 font-semibold mt-1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Developed By: Eng. Mohamed Ahmed Elkasaby
Â  Â  Â  Â  Â  Â  Â  Â  </p>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <div id="view-DIN" class="view-section">
Â  Â  Â  Â  <div class="report-container">
Â  Â  Â  Â  Â  Â  <div class="header-logo mb-6 flex items-center justify-between relative">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-1/4 flex justify-center items-center">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <img id="companyLogo_DIN" src="#" class="max-h-24 object-contain hidden">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print text-center" id="upBtn_DIN">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label class="cursor-pointer bg-gray-200 p-2 rounded text-xs">ğŸ“· Logo<input type="file" class="hidden" onchange="loadLogo(event, 'DIN')"></label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-2/4 text-center din-header">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h1 class="text-xl font-bold">Ø§Ø®ØªØ¨Ø§Ø± ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù„ÙˆØ­ (DIN 18134)<br><span class="text-sm font-normal">Plate Loading Test</span></h1>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <h2 class="text-sm text-gray-600">Strain Modulus Ev Calculation</h2>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div class="w-1/4"></div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <table class="mb-4">
Â  Â  Â  Â  Â  Â  Â  Â  <tr><th width="20%">Project</th><td><input type="text"></td><th width="20%">Date</th><td><input type="date"></td></tr>
Â  Â  Â  Â  Â  Â  Â  Â  <tr><th>Client</th><td><input type="text"></td><th>Test No.</th><td><input type="text"></td></tr>
Â  Â  Â  Â  Â  Â  </table>

Â  Â  Â  Â  Â  Â  <div class="din-result-box" style="margin-top:0; margin-bottom:20px; padding:10px;">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-center gap-10">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label><b>Plate Diameter (d):</b> <input type="number" id="din_dia" value="300" style="width:60px;"> mm</label>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <label><b>Plate Radius (r):</b> <span id="din_rad">150</span> mm</label>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="grid grid-cols-1 gap-4">
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="cycle-header">1st Loading Cycle</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table id="dinTable1">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr class="bg-gray-100"><th>Load (MN/mÂ²) (Ïƒ)</th><th>Settlement (mm) (s)</th><th class="no-print">Del</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print text-center"><button class="btn btn-primary" onclick="addDinRow('dinTable1')">+</button></div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="cycle-header" style="background:#7f8c8d;">Unloading</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table id="dinTableUnload">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr class="bg-gray-100"><th>Load (MN/mÂ²)</th><th>Settlement (mm)</th><th class="no-print">Del</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print text-center"><button class="btn btn-primary" onclick="addDinRow('dinTableUnload')">+</button></div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  Â  Â  <div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="cycle-header" style="background:#27ae60;">2nd Loading Cycle</div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <table id="dinTable2">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <thead><tr class="bg-gray-100"><th>Load (MN/mÂ²)</th><th>Settlement (mm)</th><th class="no-print">Del</th></tr></thead>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <tbody></tbody>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </table>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div class="no-print text-center"><button class="btn btn-primary" onclick="addDinRow('dinTable2')">+</button></div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="no-print text-center mt-6">
Â  Â  Â  Â  Â  Â  Â  Â  <button class="btn btn-success" onclick="calcDIN()">ğŸš€ Calculate Ev</button>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="din-result-box">
Â  Â  Â  Â  Â  Â  Â  Â  <div class="flex justify-around items-center flex-wrap">
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div><div class="text-gray-600 text-sm">Ev1</div><div class="text-2xl font-bold text-blue-800" id="res_ev1">0.00 MN/mÂ²</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div><div class="text-gray-600 text-sm">Ev2</div><div class="text-2xl font-bold text-green-800" id="res_ev2">0.00 MN/mÂ²</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  <div><div class="text-gray-600 text-sm">Ratio</div><div class="text-3xl font-extrabold text-orange-600" id="res_ratio">0.00</div></div>
Â  Â  Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â  </div>

Â  Â  Â  Â  Â  Â  <div class="mt-6" style="height: 500px; border:1px solid #ccc; padding:10px;">
Â  Â  Â  Â  Â  Â  Â  Â  <canvas id="chartDIN"></canvas>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  <div class="mt-8 pt-4 border-t border-gray-400 text-center">
Â  Â  Â  Â  Â  Â  Â  Â  <p>Ø¥Ø¹Ø¯Ø§Ø¯ ÙˆØªØ·ÙˆÙŠØ±: Ù…/ Ù…Ø­Ù…Ø¯ Ø£Ø­Ù…Ø¯ Ø§Ù„Ù‚ØµØ¨ÙŠ</p>
Â  Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  </div>

Â  Â  <script>
Â  Â  Â  Â  function switchStandard(std) {
Â  Â  Â  Â  Â  Â  document.querySelectorAll('.view-section').forEach(el => el.classList.remove('active'));
Â  Â  Â  Â  Â  Â  document.querySelectorAll('.std-btn').forEach(el => el.classList.remove('active'));
Â  Â  Â  Â  Â  Â  document.getElementById('view-' + std).classList.add('active');
Â  Â  Â  Â  Â  Â  const btns = document.querySelectorAll('.std-btn');
Â  Â  Â  Â  Â  Â  if(std === 'ASTM') btns[0].classList.add('active'); else btns[1].classList.add('active');
Â  Â  Â  Â  }

Â  Â  Â  Â  function loadLogo(e, type) {
Â  Â  Â  Â  Â  Â  const file = e.target.files[0];
Â  Â  Â  Â  Â  Â  if(file) {
Â  Â  Â  Â  Â  Â  Â  Â  const reader = new FileReader();
Â  Â  Â  Â  Â  Â  Â  Â  reader.onload = function(evt) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const img = document.getElementById('companyLogo_' + type);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(img) img.src = evt.target.result;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(type === 'ASTM') {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const img1 = document.getElementById('companyLogo');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(img1) { img1.src = evt.target.result; img1.classList.remove('hidden'); }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('uploadLogoBtnContainer').style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  } else {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  img.classList.remove('hidden');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('upBtn_' + type).style.display = 'none';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  reader.readAsDataURL(file);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  /* --- ASTM LOGIC (Preserved Original + Upgrades) --- */
Â  Â  Â  Â  let rowCounters = {};
Â  Â  Â  Â  let summaryRowCount = 0;
Â  Â  Â  Â  let chart = null;

Â  Â  Â  Â  window.addEventListener('DOMContentLoaded', () => {
Â  Â  Â  Â  Â  Â  calculatePlateArea();
Â  Â  Â  Â  Â  Â  for (let i = 1; i <= 6; i++) { rowCounters[`loading${i}`] = 0; addLoadingRow(`loading${i}`); addLoadingRow(`loading${i}`); }
Â  Â  Â  Â  Â  Â  for (let i = 1; i <= 3; i++) { rowCounters[`unloading${i}`] = 0; addUnloadingRow(`unloading${i}`); addUnloadingRow(`unloading${i}`); }
Â  Â  Â  Â  Â  Â  addSummaryRow();
Â  Â  Â  Â  Â  Â  document.getElementById('reportDate').valueAsDate = new Date();
Â  Â  Â  Â  Â  Â  document.getElementById('plateInfoPrint').style.display = 'table';
Â  Â  Â  Â  Â  Â  Chart.register(ChartDataLabels);
Â  Â  Â  Â  Â  Â  generateChart();
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  // ØªÙ‡ÙŠØ¦Ø© DIN Ø§ÙØªØ±Ø§Ø¶ÙŠØ§Ù‹
Â  Â  Â  Â  Â  Â  addDinRow('dinTable1'); addDinRow('dinTable1');
Â  Â  Â  Â  Â  Â  addDinRow('dinTableUnload');
Â  Â  Â  Â  Â  Â  addDinRow('dinTable2'); addDinRow('dinTable2');
Â  Â  Â  Â  });

Â  Â  Â  Â  // Ø¯ÙˆØ§Ù„ ASTM Ø§Ù„Ù‚Ø¯ÙŠÙ…Ø© (Ù…Ø¹ Ø§Ù„ØªØ¹Ø¯ÙŠÙ„Ø§Øª Ù„Ù„ÙˆØ­Ø¯Ø§Øª)
Â  Â  Â  Â  function calculatePlateArea() {
Â  Â  Â  Â  Â  Â  const diameter = parseFloat(document.getElementById('plateDiameter').value);
Â  Â  Â  Â  Â  Â  if (!isNaN(diameter) && diameter > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  const area = Math.PI * Math.pow(diameter / 2, 2);
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('plateArea').value = area.toFixed(2);
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('plateDiameterPrint').textContent = diameter;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('plateAreaPrint').textContent = area.toFixed(2);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }
Â  Â  Â  Â  function getPlateArea() {
Â  Â  Â  Â  Â  Â  const areaValue = parseFloat(document.getElementById('plateArea').value);
Â  Â  Â  Â  Â  Â  return isNaN(areaValue) ? 1641.73 : areaValue;
Â  Â  Â  Â  }
Â  Â  Â  Â  function switchTab(tabNumber) {
Â  Â  Â  Â  Â  Â  document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
Â  Â  Â  Â  Â  Â  document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
Â  Â  Â  Â  Â  Â  document.getElementById(`tab${tabNumber}Content`).classList.add('active');
Â  Â  Â  Â  Â  Â  document.getElementById(`tab${tabNumber}Btn`).classList.add('active');
Â  Â  Â  Â  Â  Â  window.scrollTo({ top: 0, behavior: 'smooth' });
Â  Â  Â  Â  Â  Â  if (tabNumber === 3) setTimeout(generateChart, 100);
Â  Â  Â  Â  }

Â  Â  Â  Â  function addLoadingRow(tableId) {
Â  Â  Â  Â  Â  Â  if (!rowCounters[tableId]) rowCounters[tableId] = 0;
Â  Â  Â  Â  Â  Â  rowCounters[tableId]++;
Â  Â  Â  Â  Â  Â  const tbody = document.getElementById(`${tableId}Body`);
Â  Â  Â  Â  Â  Â  const row = document.createElement('tr');
Â  Â  Â  Â  Â  Â  row.id = `${tableId}-row-${rowCounters[tableId]}`;
Â  Â  Â  Â  Â  Â  row.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <td><input type="text" class="print-compact" placeholder="HH:MM"></td>
Â  Â  Â  Â  Â  Â  Â  Â  <td class="bg-yellow-50"><input type="number" step="0.001" class="mpa-input print-compact" oninput="calculateRow(this)" placeholder="Pressure"></td>
Â  Â  Â  Â  Â  Â  Â  Â  <td class="bg-gray-50"><input type="number" step="0.01" class="load-input print-compact" onchange="calculateRow(this)" readonly></td>
Â  Â  Â  Â  Â  Â  Â  Â  <td><input type="number" step="0.001" class="gauge-input print-compact" onchange="calculateRow(this)"></td>
Â  Â  Â  Â  Â  Â  Â  Â  <td><input type="number" step="0.001" class="gauge-input print-compact" onchange="calculateRow(this)"></td>
Â  Â  Â  Â  Â  Â  Â  Â  <td><input type="number" step="0.001" class="gauge-input print-compact" onchange="calculateRow(this)"></td>
Â  Â  Â  Â  Â  Â  Â  Â  <td class="calculated average-cell">-</td>
Â  Â  Â  Â  Â  Â  Â  Â  <td class="calculated settlement-cell">-</td>
Â  Â  Â  Â  Â  Â  Â  Â  <td class="stress-calculated stress-cell">-</td>
Â  Â  Â  Â  Â  Â  Â  Â  <td><input type="number" step="0.1" class="print-compact" placeholder="Â°C"></td>
Â  Â  Â  Â  Â  Â  Â  Â  <td class="no-print"><button onclick="removeRow('${row.id}')" class="btn btn-danger btn-sm" style="padding:0px 6px;">âœ•</button></td>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  tbody.appendChild(row);
Â  Â  Â  Â  }

Â  Â  Â  Â  function addUnloadingRow(tableId) { addLoadingRow(tableId); }

Â  Â  Â  Â  function calculateRow(input) {
Â  Â  Â  Â  Â  Â  const row = input.closest('tr');
Â  Â  Â  Â  Â  Â  const gaugeInputs = row.querySelectorAll('.gauge-input');
Â  Â  Â  Â  Â  Â  const loadInput = row.querySelector('.load-input');
Â  Â  Â  Â  Â  Â  const mpaInput = row.querySelector('.mpa-input');
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  const unit = document.getElementById('gauge_unit').value;
Â  Â  Â  Â  Â  Â  let gaugeValue = parseFloat(mpaInput.value);
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  if (!isNaN(gaugeValue)) {
Â  Â  Â  Â  Â  Â  Â  Â  let pressureMPa = 0;
Â  Â  Â  Â  Â  Â  Â  Â  if (unit === 'MPa') pressureMPa = gaugeValue;
Â  Â  Â  Â  Â  Â  Â  Â  else if (unit === 'Bar') pressureMPa = gaugeValue / 10;
Â  Â  Â  Â  Â  Â  Â  Â  else if (unit === 'psi') pressureMPa = gaugeValue / 145.038;
Â  Â  Â  Â  Â  Â  Â  Â  else if (unit === 'kg_cm2') pressureMPa = gaugeValue / 10.197;

Â  Â  Â  Â  Â  Â  Â  Â  const factor = parseFloat(document.getElementById('ramFactor').value) || 16.428;
Â  Â  Â  Â  Â  Â  Â  Â  let loadTon = pressureMPa * factor;
Â  Â  Â  Â  Â  Â  Â  Â  loadInput.value = loadTon.toFixed(2);

Â  Â  Â  Â  Â  Â  Â  Â  const area = getPlateArea();
Â  Â  Â  Â  Â  Â  Â  Â  row.querySelector('.stress-cell').textContent = ((loadTon * 1000) / area).toFixed(2);
Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  let sum = 0, count = 0;
Â  Â  Â  Â  Â  Â  gaugeInputs.forEach(g => { if(g.value!=='') { sum+=parseFloat(g.value); count++; } });
Â  Â  Â  Â  Â  Â  if (count === 3) {
Â  Â  Â  Â  Â  Â  Â  Â  const avg = sum / 3;
Â  Â  Â  Â  Â  Â  Â  Â  row.querySelector('.average-cell').textContent = avg.toFixed(3);
Â  Â  Â  Â  Â  Â  Â  Â  row.querySelector('.settlement-cell').textContent = (avg * 0.001).toFixed(3);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }

Â  Â  Â  Â  function updateCalculations() {
Â  Â  Â  Â  Â  Â  const unit = document.getElementById('gauge_unit').value;
Â  Â  Â  Â  Â  Â  const labels = document.querySelectorAll('.unit-disp');
Â  Â  Â  Â  Â  Â  labels.forEach(l => l.innerText = `(${unit})`);
Â  Â  Â  Â  Â  Â  document.querySelectorAll('.mpa-input').forEach(inp => calculateRow(inp));
Â  Â  Â  Â  }

Â  Â  Â  Â  function autoUpdateStages() {
Â  Â  Â  Â  Â  Â  const designLoad = parseFloat(document.getElementById('design_load').value);
Â  Â  Â  Â  Â  Â  if(isNaN(designLoad) || designLoad <= 0) return;
Â  Â  Â  Â  Â  Â  const multipliers = [0.50, 1.00, 1.50, 2.00, 2.50, 3.00];
Â  Â  Â  Â  Â  Â  for(let i=1; i<=6; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  let val = (designLoad * multipliers[i-1]).toFixed(2);
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById(`loadingStageLabel${i}`).value = `${val} kg/cmÂ²`;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  document.getElementById(`unloadingStageLabel1`).value = `${(designLoad * 2.00).toFixed(2)} kg/cmÂ²`;
Â  Â  Â  Â  Â  Â  document.getElementById(`unloadingStageLabel2`).value = `${(designLoad * 1.00).toFixed(2)} kg/cmÂ²`;
Â  Â  Â  Â  Â  Â  document.getElementById(`unloadingStageLabel3`).value = `0.00 kg/cmÂ²`;
Â  Â  Â  Â  }

Â  Â  Â  Â  function addSummaryRow() {
Â  Â  Â  Â  Â  Â  summaryRowCount++;
Â  Â  Â  Â  Â  Â  const tbody = document.getElementById('summaryBody');
Â  Â  Â  Â  Â  Â  const row = document.createElement('tr');
Â  Â  Â  Â  Â  Â  row.id = `summary-row-${summaryRowCount}`;
Â  Â  Â  Â  Â  Â  row.innerHTML = `
Â  Â  Â  Â  Â  Â  Â  Â  <td><select class="stage-select print-compact" onchange="generateChart()" style="border:none;background:transparent;"><option value="Loading">ØªØ­Ù…ÙŠÙ„</option><option value="Unloading">Ø±ÙØ¹</option></select></td>
Â  Â  Â  Â  Â  Â  Â  Â  <td><input type="number" step="0.01" class="load-input print-compact" oninput="calculateStressSummary(this)"></td>
Â  Â  Â  Â  Â  Â  Â  Â  <td class="calculated stress-cell">-</td>
Â  Â  Â  Â  Â  Â  Â  Â  <td><input type="number" step="0.001" class="settlement-input print-compact" oninput="generateChart()"></td>
Â  Â  Â  Â  Â  Â  Â  Â  <td class="no-print"><button onclick="removeRow('${row.id}'); generateChart()" class="btn btn-danger btn-sm">âœ•</button></td>
Â  Â  Â  Â  Â  Â  `;
Â  Â  Â  Â  Â  Â  tbody.appendChild(row);
Â  Â  Â  Â  }

Â  Â  Â  Â  function calculateStressSummary(input) {
Â  Â  Â  Â  Â  Â  const row = input.closest('tr');
Â  Â  Â  Â  Â  Â  const load = parseFloat(input.value);
Â  Â  Â  Â  Â  Â  if (!isNaN(load)) {
Â  Â  Â  Â  Â  Â  Â  Â  const area = getPlateArea();
Â  Â  Â  Â  Â  Â  Â  Â  row.querySelector('.stress-cell').textContent = ((load * 1000) / area).toFixed(2);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  generateChart();
Â  Â  Â  Â  }

Â  Â  Â  Â  function autoFillSummary() {
Â  Â  Â  Â  Â  Â  document.getElementById('summaryBody').innerHTML = '';
Â  Â  Â  Â  Â  Â  summaryRowCount = 0;
Â  Â  Â  Â  Â  Â  addSummaryRow();
Â  Â  Â  Â  Â  Â  let r = document.getElementById(`summary-row-${summaryRowCount}`);
Â  Â  Â  Â  Â  Â  r.querySelector('.stage-select').value = 'Loading';
Â  Â  Â  Â  Â  Â  r.querySelector('.load-input').value = '0.00';
Â  Â  Â  Â  Â  Â  r.querySelector('.settlement-input').value = '0.000';
Â  Â  Â  Â  Â  Â  r.querySelector('.stress-cell').textContent = '0.00';

Â  Â  Â  Â  Â  Â  for (let i = 1; i <= 6; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  const rows = document.querySelectorAll(`#loading${i}Body tr`);
Â  Â  Â  Â  Â  Â  Â  Â  if (rows.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const last = rows[rows.length - 1];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (last.querySelector('.load-input').value) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addSummaryRow();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r = document.getElementById(`summary-row-${summaryRowCount}`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r.querySelector('.stage-select').value = 'Loading';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r.querySelector('.load-input').value = last.querySelector('.load-input').value;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r.querySelector('.settlement-input').value = last.querySelector('.settlement-cell').textContent;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r.querySelector('.stress-cell').textContent = last.querySelector('.stress-cell').textContent;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  for (let i = 1; i <= 3; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  const rows = document.querySelectorAll(`#unloading${i}Body tr`);
Â  Â  Â  Â  Â  Â  Â  Â  if (rows.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const last = rows[rows.length - 1];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (last.querySelector('.load-input').value) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  addSummaryRow();
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r = document.getElementById(`summary-row-${summaryRowCount}`);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r.querySelector('.stage-select').value = 'Unloading';
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r.querySelector('.load-input').value = last.querySelector('.load-input').value;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r.querySelector('.settlement-input').value = last.querySelector('.settlement-cell').textContent;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  r.querySelector('.stress-cell').textContent = last.querySelector('.stress-cell').textContent;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  generateChart();
Â  Â  Â  Â  }

Â  Â  Â  Â  function generateChart() {
Â  Â  Â  Â  Â  Â  const rows = document.querySelectorAll('#summaryBody tr');
Â  Â  Â  Â  Â  Â  const loadingData = [], unloadingData = [];
Â  Â  Â  Â  Â  Â  rows.forEach(row => {
Â  Â  Â  Â  Â  Â  Â  Â  const stage = row.querySelector('.stage-select').value;
Â  Â  Â  Â  Â  Â  Â  Â  const stress = parseFloat(row.querySelector('.stress-cell').textContent);
Â  Â  Â  Â  Â  Â  Â  Â  const sett = parseFloat(row.querySelector('.settlement-input').value);
Â  Â  Â  Â  Â  Â  Â  Â  if (!isNaN(stress) && !isNaN(sett)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const pt = { x: stress, y: sett };
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (stage === 'Loading') loadingData.push(pt);Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  else unloadingData.push(pt);
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  loadingData.sort((a,b) => a.x - b.x);
Â  Â  Â  Â  Â  Â  unloadingData.sort((a,b) => b.x - a.x);

Â  Â  Â  Â  Â  Â  const ctx = document.getElementById('stressSettlementChart').getContext('2d');
Â  Â  Â  Â  Â  Â  if (chart) chart.destroy();

Â  Â  Â  Â  Â  Â  chart = new Chart(ctx, {
Â  Â  Â  Â  Â  Â  Â  Â  type: 'line',
Â  Â  Â  Â  Â  Â  Â  Â  data: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  datasets: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { label: 'Loading', data: loadingData, borderColor: '#1F4E79', backgroundColor: '#C00000', pointBackgroundColor: '#C00000', pointBorderColor: '#C00000', pointStyle: 'rectRot', pointRadius: 5, borderWidth: 2, tension: 0, fill: false },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { label: 'Unloading', data: unloadingData, borderColor: '#1F4E79', backgroundColor: '#C00000', pointBackgroundColor: '#C00000', pointBorderColor: '#C00000', pointStyle: 'rectRot', pointRadius: 5, borderWidth: 2, borderDash: [], tension: 0, fill: false }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  options: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  responsive: true, maintainAspectRatio: false,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  layout: { padding: { top: 30, right: 30, left: 10, bottom: 10 } },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  plugins: { legend: { display: false }, tooltip: { enabled: false }, datalabels: { display: true, align: 'right', anchor: 'center', offset: 6, color: '#000', font: { weight: 'bold', size: 11 }, formatter: (v) => v.y.toFixed(3) } },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scales: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  x: { type: 'linear', position: 'top', title: { display: true, text: 'Stress (kg/cmÂ²)', font: {weight:'bold', size: 12}, color: '#000' }, min: 0, max: 4.5, grid: { color: '#000', lineWidth: 0.5 }, ticks: { color: '#000', font: {weight:'bold'} } },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  y: { reverse: true, title: { display: true, text: 'Settlement (mm)', font: {weight:'bold', size: 12}, color: '#000' }, min: 0, grid: { color: '#000', lineWidth: 0.5 }, ticks: { color: '#000', font: {weight:'bold'} } }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  calculateKValue(loadingData);
Â  Â  Â  Â  }

Â  Â  Â  Â  function saveToLocal() {
Â  Â  Â  Â  Â  Â  const data = {
Â  Â  Â  Â  Â  Â  Â  Â  project: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  name: document.getElementById('projectName').value,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  order: document.getElementById('orderNo').value,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  client: document.getElementById('client').value,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  date: document.getElementById('testDate').value,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  location: document.getElementById('location').value,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  reportDate: document.getElementById('reportDate').value,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  plateDiameter: document.getElementById('plateDiameter').value,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ramFactor: document.getElementById('ramFactor').value
Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  loadingTables: {},
Â  Â  Â  Â  Â  Â  Â  Â  unloadingTables: {}
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  for (let i = 1; i <= 6; i++) data.loadingTables[`loading${i}`] = getTableData(`loading${i}`);
Â  Â  Â  Â  Â  Â  for (let i = 1; i <= 3; i++) data.unloadingTables[`unloading${i}`] = getTableData(`unloading${i}`);
Â  Â  Â  Â  Â  Â  localStorage.setItem('plateTestBackup', JSON.stringify(data));
Â  Â  Â  Â  Â  Â  alert('âœ… ØªÙ… Ø­ÙØ¸ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø¤Ù‚ØªØ§Ù‹!');
Â  Â  Â  Â  }

Â  Â  Â  Â  function calculateKValue(loadingData) {
Â  Â  Â  Â  Â  Â  if (!loadingData || loadingData.length === 0) { document.getElementById('kValueResult').textContent = "0.00"; return; }
Â  Â  Â  Â  Â  Â  const lastPoint = loadingData[loadingData.length - 1];
Â  Â  Â  Â  Â  Â  const stress = lastPoint.x; const settlementMM = lastPoint.y;
Â  Â  Â  Â  Â  Â  if (settlementMM > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  const settlementCM = settlementMM / 10;
Â  Â  Â  Â  Â  Â  Â  Â  const kVal = stress / settlementCM;
Â  Â  Â  Â  Â  Â  Â  Â  document.getElementById('kValueResult').textContent = kVal.toFixed(2);
Â  Â  Â  Â  Â  Â  } else { document.getElementById('kValueResult').textContent = "0.00"; }
Â  Â  Â  Â  }

Â  Â  Â  Â  function getTableData(tableId) {
Â  Â  Â  Â  Â  Â  const rows = [];
Â  Â  Â  Â  Â  Â  document.querySelectorAll(`#${tableId}Body tr`).forEach(tr => {
Â  Â  Â  Â  Â  Â  Â  Â  rows.push({
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  time: tr.querySelector('td:nth-child(1) input').value,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  mpa: tr.querySelector('.mpa-input').value,Â 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  g1: tr.querySelectorAll('.gauge-input')[0].value,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  g2: tr.querySelectorAll('.gauge-input')[1].value,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  g3: tr.querySelectorAll('.gauge-input')[2].value,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  temp: tr.querySelector('td:nth-child(10) input').value
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  return rows;
Â  Â  Â  Â  }

Â  Â  Â  Â  function loadFromLocal() {
Â  Â  Â  Â  Â  Â  const json = localStorage.getItem('plateTestBackup');
Â  Â  Â  Â  Â  Â  if (!json) { alert('âŒ Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ø­ÙÙˆØ¸Ø©!'); return; }
Â  Â  Â  Â  Â  Â  if(!confirm('Ø§Ø³ØªØ±Ø¬Ø§Ø¹ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ù…Ø­ÙÙˆØ¸Ø©ØŸ (Ø³ÙŠØªÙ… Ù…Ø³Ø­ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø­Ø§Ù„ÙŠØ©)')) return;
Â  Â  Â  Â  Â  Â  const data = JSON.parse(json);
Â  Â  Â  Â  Â  Â  document.getElementById('projectName').value = data.project.name;
Â  Â  Â  Â  Â  Â  document.getElementById('orderNo').value = data.project.order;
Â  Â  Â  Â  Â  Â  document.getElementById('client').value = data.project.client;
Â  Â  Â  Â  Â  Â  document.getElementById('testDate').value = data.project.date;
Â  Â  Â  Â  Â  Â  document.getElementById('location').value = data.project.location;
Â  Â  Â  Â  Â  Â  document.getElementById('reportDate').value = data.project.reportDate;
Â  Â  Â  Â  Â  Â  document.getElementById('plateDiameter').value = data.project.plateDiameter;
Â  Â  Â  Â  Â  Â  document.getElementById('ramFactor').value = data.project.ramFactor;
Â  Â  Â  Â  Â  Â  calculatePlateArea();
Â  Â  Â  Â  Â  Â  const restore = (id, rows) => {
Â  Â  Â  Â  Â  Â  Â  Â  const body = document.getElementById(`${id}Body`);
Â  Â  Â  Â  Â  Â  Â  Â  body.innerHTML = ''; rowCounters[id] = 0;
Â  Â  Â  Â  Â  Â  Â  Â  if(rows) rows.forEach(r => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  id.includes('unloading') ? addUnloadingRow(id) : addLoadingRow(id);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const tr = body.lastElementChild;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tr.querySelector('td:nth-child(1) input').value = r.time;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tr.querySelector('.mpa-input').value = r.mpa;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tr.querySelectorAll('.gauge-input')[0].value = r.g1;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tr.querySelectorAll('.gauge-input')[1].value = r.g2;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tr.querySelectorAll('.gauge-input')[2].value = r.g3;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  tr.querySelector('td:nth-child(10) input').value = r.temp;
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  calculateRow(tr.querySelector('.mpa-input'));
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  for (let i = 1; i <= 6; i++) restore(`loading${i}`, data.loadingTables[`loading${i}`]);
Â  Â  Â  Â  Â  Â  for (let i = 1; i <= 3; i++) restore(`unloading${i}`, data.unloadingTables[`unloading${i}`]);
Â  Â  Â  Â  Â  Â  autoFillSummary();
Â  Â  Â  Â  Â  Â  alert('âœ… ØªÙ… Ø§Ù„Ø§Ø³ØªØ±Ø¬Ø§Ø¹!');
Â  Â  Â  Â  }

Â  Â  Â  Â  function removeRow(id) { document.getElementById(id)?.remove(); }
Â  Â  Â  Â  function removeLastRow(id) { const b = document.getElementById(id); if(b.lastChild) b.removeChild(b.lastChild); }
Â  Â  Â  Â  function resetNewTest() { if(confirm('Ø­Ø°Ù ÙƒÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§ØªØŸ')) location.reload(); }
Â  Â  Â  Â  function calculateAllResults() { autoFillSummary(); alert('ØªÙ… Ø§Ù„Ø­Ø³Ø§Ø¨ ÙˆØ§Ù„ØªØ­Ø¯ÙŠØ«'); }

Â  Â  Â  Â  /* --- DIN LOGIC --- */
Â  Â  Â  Â  function polyFit(xArr, yArr) {
Â  Â  Â  Â  Â  Â  if (typeof math === 'undefined') return [0,0,0];
Â  Â  Â  Â  Â  Â  let n = xArr.length;
Â  Â  Â  Â  Â  Â  let sumX=0, sumX2=0, sumX3=0, sumX4=0, sumY=0, sumXY=0, sumX2Y=0;
Â  Â  Â  Â  Â  Â  for(let i=0; i<n; i++) {
Â  Â  Â  Â  Â  Â  Â  Â  let x = xArr[i], y = yArr[i];
Â  Â  Â  Â  Â  Â  Â  Â  sumX+=x; sumX2+=x*x; sumX3+=x*x*x; sumX4+=x*x*x*x;
Â  Â  Â  Â  Â  Â  Â  Â  sumY+=y; sumXY+=x*y; sumX2Y+=x*x*y;
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  let A = [[n, sumX, sumX2], [sumX, sumX2, sumX3], [sumX2, sumX3, sumX4]];
Â  Â  Â  Â  Â  Â  let B = [sumY, sumXY, sumX2Y];
Â  Â  Â  Â  Â  Â  try { let X = math.lusolve(A, B); return [Number(X[0]), Number(X[1]), Number(X[2])]; }Â 
Â  Â  Â  Â  Â  Â  catch(e) { return [0,0,0]; }
Â  Â  Â  Â  }

Â  Â  Â  Â  let chartDIN_Obj = null;
Â  Â  Â  Â  function addDinRow(tableId) {
Â  Â  Â  Â  Â  Â  const row = `<tr><td><input type="number" step="0.01"></td><td><input type="number" step="0.01"></td><td class="no-print"><button class="btn btn-danger btn-sm" onclick="this.closest('tr').remove()">x</button></td></tr>`;
Â  Â  Â  Â  Â  Â  document.getElementById(tableId).querySelector('tbody').insertAdjacentHTML('beforeend', row);
Â  Â  Â  Â  }
Â  Â  Â  Â  document.getElementById('din_dia').addEventListener('input', function() {
Â  Â  Â  Â  Â  Â  document.getElementById('din_rad').innerText = (this.value / 2).toFixed(1);
Â  Â  Â  Â  });

Â  Â  Â  Â  function calcDIN() {
Â  Â  Â  Â  Â  Â  let getData = (id) => {
Â  Â  Â  Â  Â  Â  Â  Â  let arr = [];
Â  Â  Â  Â  Â  Â  Â  Â  document.querySelectorAll(`#${id} tbody tr`).forEach(tr => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let ins = tr.querySelectorAll('input');
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  let s = parseFloat(ins[0].value), set = parseFloat(ins[1].value);
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if(!isNaN(s) && !isNaN(set)) arr.push({x:s, y:set});
Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  return arr;
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  let data1 = getData('dinTable1'), dataUn = getData('dinTableUnload'), data2 = getData('dinTable2');
Â  Â  Â  Â  Â  Â  if(data1.length < 3 || data2.length < 3) { alert("Add points!"); return; }

Â  Â  Â  Â  Â  Â  let r_mm = parseFloat(document.getElementById('din_rad').innerText);
Â  Â  Â  Â  Â  Â  let sigma_max1 = data1[data1.length-1].x;

Â  Â  Â  Â  Â  Â  let x1 = data1.map(p=>p.x), y1 = data1.map(p=>p.y);
Â  Â  Â  Â  Â  Â  let coeffs1 = polyFit(x1, y1);
Â  Â  Â  Â  Â  Â  let Ev1 = 1.5 * r_mm * (1 / (coeffs1[1] + coeffs1[2] * sigma_max1));

Â  Â  Â  Â  Â  Â  let x2 = data2.map(p=>p.x), y2 = data2.map(p=>p.y);
Â  Â  Â  Â  Â  Â  let coeffs2 = polyFit(x2, y2);
Â  Â  Â  Â  Â  Â  let Ev2 = 1.5 * r_mm * (1 / (coeffs2[1] + coeffs2[2] * sigma_max1));Â 
Â  Â  Â  Â  Â  Â Â 
Â  Â  Â  Â  Â  Â  document.getElementById('res_ev1').innerText = Ev1.toFixed(2) + " MN/mÂ²";
Â  Â  Â  Â  Â  Â  document.getElementById('res_ev2').innerText = Ev2.toFixed(2) + " MN/mÂ²";
Â  Â  Â  Â  Â  Â  document.getElementById('res_ratio').innerText = (Ev2/Ev1).toFixed(2);

Â  Â  Â  Â  Â  Â  let genCurve = (coeffs, maxX) => {
Â  Â  Â  Â  Â  Â  Â  Â  let pts = [];
Â  Â  Â  Â  Â  Â  Â  Â  for(let x=0; x<=maxX; x+=maxX/20) pts.push({x: x, y: coeffs[0] + coeffs[1]*x + coeffs[2]*x*x});
Â  Â  Â  Â  Â  Â  Â  Â  return pts;
Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  let curve1 = genCurve(coeffs1, sigma_max1);
Â  Â  Â  Â  Â  Â  let curve2 = genCurve(coeffs2, data2[data2.length-1].x);

Â  Â  Â  Â  Â  Â  if(chartDIN_Obj) chartDIN_Obj.destroy();
Â  Â  Â  Â  Â  Â  const ctx = document.getElementById('chartDIN').getContext('2d');
Â  Â  Â  Â  Â  Â  chartDIN_Obj = new Chart(ctx, {
Â  Â  Â  Â  Â  Â  Â  Â  type: 'scatter',
Â  Â  Â  Â  Â  Â  Â  Â  data: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  datasets: [
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { label: 'Cycle 1', data: data1, backgroundColor: 'blue' },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { label: 'Fit 1', data: curve1, type:'line', borderColor:'blue', pointRadius:0, fill:false },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { label: 'Unload', data: dataUn, type:'line', borderColor:'gray', borderDash:[5,5], fill:false },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { label: 'Cycle 2', data: data2, backgroundColor: 'green' },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  { label: 'Fit 2', data: curve2, type:'line', borderColor:'green', pointRadius:0, fill:false }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ]
Â  Â  Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  Â  Â  options: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  scales: {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  x: { type:'linear', position:'top', title:{display:true, text:'Stress (MN/mÂ²)'} },
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  y: { reverse:true, title:{display:true, text:'Settlement (mm)'} }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  }
Â  Â  </script>
</body>
</html>
